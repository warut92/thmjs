function convert() {
//นำอักขะมาจาก textarea
let input = document.getElementById("thm_textarea").value;

//เปลี่ยนโน้ตคู่ เนื่องจาก หลังเครื่องหมายทับ เป็นการแสดงโน้ตคู่ ไม่ใช่ตัวโน้ตในคู่นั้น
input = input
 //คู่ 4
.replace(/8\/4/g,"8/5")
.replace(/1\*\/4/g,"8/5")
.replace(/7\/4/g,"7/7")
.replace(/6\/4/g,"6/3")
.replace(/5\/4/g,"5/2")
.replace(/4\/4/g,"4/1")
.replace(/3\/4/g,"3/7.")
.replace(/2\/4/g,"2/6.")
.replace(/1\/4/g,"1/5.")
.replace(/7.\/4/g,"7./4.")
.replace(/6.\/4/g,"6./3.")
//คู่ 8
.replace(/3\*\/8/g,"3*/3") 
.replace(/9\/8/g,"9/2") 
.replace(/2\*\/8/g,"2*/2") 
.replace(/8\/8/g,"8/1") 
.replace(/1\*\/8/g,"8/1") 
.replace(/7\/8/g,"7/7.") 
.replace(/6\/8/g,"6/6.") 
.replace(/5\/8/g,"5/5.") 
.replace(/4\/8/g,"4/4.") 
.replace(/3\/8/g,"3/3.") 
.replace(/2\/8/g,"2/2.") 
.replace(/\*\/8/g,"/1")
// //คู่ 3*
.replace(/3\*\/5/g,"3*/6")
.replace(/3\*\/6/g,"3*/5") 
//คู่ 6
.replace(/6\/5/g,"6/2") 
.replace(/6\/4/g,"6/3") 
console.log("input",input);
document.getElementById('input_converted').value = input
//ตัวแปร regex ในรูปแบบต่าง
// เมื่อได้โน้ตออกมา จะเป็นโน้ตในลักษณะ 2 บรรทัด
// วิธีการคือ จับรูปแบบของโน้ตแล้ว แยกออกเป็น 2 บรรทัด
const groups = input.split(" ");
console.log(groups);
const topLine = groups.map(g => 
  g                                         
  // 1 ตัว
  .replace(/---(\d)\/(\d)\./g, "---$1")   //---x/8.
  .replace(/---(\d)\/(\d)/g, "---$1")   //---x/8
  // .replace(/---(\d)/g, "----")              //---x
  .replace(/---(\d)\.\/(\d)/g, "---$1")     //---x./8
  .replace(/-(\d)\*\/(\d)--/g, "-$1*--")    //-x/6--

  // 2 ตัว
  .replace(/-(\d)\/(\d)-(\d)\/(\d)/g, "-$1-$3")   //-x/8-x/8
  .replace(/-(\d)\/(\d)-(\d)\/-/g, "-$1-$3")        //-x-x
  .replace(/-(\d)\/(\d)-(\d)\/(\d)/g, "-$1-$2")
  .replace(/-(\d)\/(\d)\.-(\d)\/(\d)\./g, "-$1-$3")
  .replace(/-(\d)\/(\d)-(\d)\./g, "-$1--")   //-x/8-x.+
  .replace(/-(\d)\*\/(\d)-(\d)\*\/(\d)/g, "-$1*-$3*")   //-x*-x*
  .replace(/--(\d)\/(\d)(\d)\/(\d)/g, "--$1$3")   //--xx
  .replace(/--(\d)\/(\d)(\d)\/-/g, "--$1$3")
  .replace(/--(\d)\+(\d)\+/g, "--$1$2")   //--x+x+
  .replace(/-(\d)\.--\/(\d)\./g, "--$1$2")   //-x.xx/8
  .replace(/-(\d)(\.)\/(\d)-(\d)(\.)/g, "-$1--")   //-x./x-x.
  .replace(/-(\d)\/(\d)(.{0,1})-(\d)(.{0,1})/g, "-$1---")   //-x./x-x.
  .replace(/-(\d)\*\/(\d)-(\d)/g, "-$1*--")   //-x*/x-x.


  // 3 ตัว
  .replace(/-(\d)\.(\d)(\d)\/(\d)/g, "--$2$3")    //-x.xx/8 
  .replace(/-(\d)\.(\d)(\d)/g, "--$2$3")    //-x.xx 
  .replace(/-(\d)(\d)\*(\d)\*/g, "--$2$3")    //-xx*x* 
  .replace(/-(\d)(\d)(\d)/g, "--$2$3")      //-xx+x+
  .replace(/-(\d)\+(\d)(\d)/g, "-$1--")     //-x+xx
  .replace(/-(\d)(\d)\+(\d)/g, "--$2-")     //-xx+x
  .replace(/(\d)(\d)-(\d)\/(\d)(\.)/g, "$1$2-$3") //แบบ xx-x/4.
  .replace(/(\d)(\d)-(\d)\/-/g, "---$3")
  .replace(/(\d)\*(\d)\*-(\d)/g, "$1*$2*--")    //x*x*-x
  .replace(/(\d)(\d)-(\d)\./g, "$1$2--")    //xx-x.

  //4 ตัว
  .replace(/(\d)(\d)(\d)\+(\d)\+/g, "--$3$4")   //xxx+x+
  .replace(/(\d)\+(\d)\+(\d)\+(\d)/g, "$1$2$3-")   //x+xxx+
  .replace(/(\d)\+(\d)\+(\d)(\d)/g, "$1$2--")   //xxx+x+
  .replace(/(\d)(\d)(\d)(\d)\/(\d)/g, "$1$2$3$4")   //xxxx/x
  .replace(/(\d)(\d)\+(\d)(\d)\/(\d)\./g, "-$2-$4")   //xx+xx/x
  .replace(/(\d)\+(\d)\+(\d)-\/(\d)/g, "$1$2-$4")   //x+x+xx/8
  .replace(/(\d)(\d)\+(\d)(\d)\/(\d)/g, "-$2-$4")   //xx+xx/8
  //ลบ tag ข้อความ
  .replace(/\(([^ )]*)\)/g, '($1)')
).join(" ");

// second line (remove +, replace / with -)
const bottomLine = groups.map(g =>
  g

  //ไม่ได้ทำอะไร ให้โน้ตปรากฏบรรทัดล่างตามปกติ   //---x+
  .replace(/---(\d)\/(\d)/g, "---$2")   //---x./8
  .replace(/---(\d)\.\/(\d)/g, "---$2")   // ---x./8
  
  // 2 ตัว
  .replace(/-(\d)\/(\d)-(\d)\/(\d)/g, "-$2-$4")   //โน้ตคู่ -x-x
  .replace(/-(\d)\*-(\d)\*/g, "-$1-$2")   //โน้ตคู่ -x*-x* สำหรับต่ำ
  .replace(/-(\d)\*\/(\d)-(\d)\*\/(\d)/g, "-$2-$4")
  .replace(/-(\d)\/(\d)-(\d)\./g, "-$2-$3.")   //-x/8-x.+
  .replace(/-(\d)\/(\d)(\.|\*)-(\d)\/(\d)(\.|\*)/g, "-$2$3-$5$6")
  .replace(/--(\d)\/(\d)(\d)\/(\d)/g, "--$2$4")   //--xx
  .replace(/--(\d)\+(\d)\+/g, "----")   //--x+x+
  .replace(/-(\d)(\.)\/(\d)-(\d)(\.)/g, "-$3-$4$5")   //-x./x-x.
  .replace(/-(\d)\/(\d)(.{0,1})-(\d)(.{0,1})/g, "-$2$3-$4$5")   //-x./x-x.
  .replace(/-(\d)\*\/(\d)-(\d)/g, "-$2-$3")   //-x*/x-x.

  // 3 ตัว
  .replace(/-(\d)\.(\d)(\d)/g, "-$1.--")   //-x.xx
  .replace(/-(\d)\.(\d)(\d)\/(\d)/g, "-$1.-$4")   //-x.xx/d
  .replace(/-(\d)(\d)\*(\d)\*/g, "-$1--")    //-xx*x* 
  .replace(/-(\d)\*\/(\d)--/g, "-$2--")   //-x/d--
  .replace(/-(\d)(\d)(\d)/g, "-$1--")   //โน้ตสบัดขึ้น -xxx
  .replace(/-(\d)\+(\d)(\d)/g, "--$2$3")   //โน้ตสบัดลง -xxx
  .replace(/-(\d)(\d)\+(\d)/g, "-$1-$3")   //โน้ต3ตัวสับ -xx+x
  .replace(/-(\d)\.--\/(\d)\./g, "-$1.-$2")   //-x.xx/8
  .replace(/(\d)(\d)-(\d)\/(\d)/g, "---$3")    //xx-x
  .replace(/(\d)(\d)-(\d)/g, "---$3")    //xx-x
  .replace(/(\d)(\d)-(\d)\./g, "---$3.")   //xx-x.
  .replace(/(\d)\*(\d)\*-(\d)/g, "---$3")    //x*x*-x
  .replace(/(\d)(\d)-(\d)\/(\d)/g, "---$4")     //แบบ xx-x/4
  
  // 4 ตัว
  .replace(/(\d)(\d)(\d)\+(\d)\+/g, "$1$2--")   //แบบ xxxx 22 มือล่าง
  .replace(/(\d)\+(\d)\+(\d)\+(\d)/g, "---$4")   //x+x+x+x
  .replace(/(\d)\+(\d)\+(\d)(\d)/g, "--$3$4")   //x+x+xx
  .replace(/(\d)(\d)(\d)(\d)\/(\d)/g, "---$5")   //xxxx/8
  .replace(/(\d)(\d)\+(\d)(\d)\/(\d)/g, "$1-$3$5")     //xx+xx/8


  .replace(/\(([^ )]*)\)/g, '')
).join(" ");

console.log("บน", topLine);
console.log("ล่าง",bottomLine); // add br for bottom
const TOPLINE = topLine.split('\n')
const BOTTOMLINE = bottomLine.split('\n')

const BOTTOMLINExNEWLINE = BOTTOMLINE.map(x => x + "\n")
const element = TOPLINE.map((num, i) => [num, BOTTOMLINExNEWLINE[i]])
let rearange_note = element.toString().replace(/,/g,"\n")
document.getElementById('thm_num').innerText = rearange_note
}

convert()


